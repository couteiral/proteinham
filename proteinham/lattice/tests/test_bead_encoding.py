from proteinham.lattice import BeadHamiltonian2D

def test_HPPH_2D():

    ham = BeadHamiltonian2D('HPPH')
    ham.build_exp()
    bitstrings = {
        '0010101010000000':   -1.000000,
        '1000101000100000':   -1.000000,
        '1010001000001000':   -1.000000,
        '1010011001001000':   -1.000000,
        '0000001010101000':   -1.000000,
        '0100011010101000':   -1.000000,
        '0110101010000100':   -1.000000,
        '0110111011000100':   -1.000000,
        '1000101001100100':   -1.000000,
        '1100111001100100':   -1.000000,
        '1110011001001100':   -1.000000,
        '0100011011101100':   -1.000000,
        '1010100000000010':   -1.000000,
        '0000100010100010':   -1.000000,
        '0001100110100010':   -1.000000,
        '1010100100010010':   -1.000000,
        '0010000010001010':   -1.000000,
        '0110010010001010':   -1.000000,
        '1000000000101010':   -1.000000,
        '1001000100101010':   -1.000000,
        '1000010001101010':   -1.000000,
        '1001010101101010':   -1.000000,
        '0010000110011010':   -1.000000,
        '0110010110011010':   -1.000000,
        '1010100001000110':   -1.000000,
        '1110110001000110':   -1.000000,
        '0100100010100110':   -1.000000,
        '0101100110100110':   -1.000000,
        '0100110011100110':   -1.000000,
        '0101110111100110':   -1.000000,
        '1010100101010110':   -1.000000,
        '1110110101010110':   -1.000000,
        '0110010011001110':   -1.000000,
        '1100010001101110':   -1.000000,
        '1101010101101110':   -1.000000,
        '0110010111011110':   -1.000000,
        '1001101000100001':   -1.000000,
        '0010101010010001':   -1.000000,
        '0011101110010001':   -1.000000,
        '1001101100110001':   -1.000000,
        '0001001010101001':   -1.000000,
        '0101011010101001':   -1.000000,
        '1010001000011001':   -1.000000,
        '1011001100011001':   -1.000000,
        '1010011001011001':   -1.000000,
        '1011011101011001':   -1.000000,
        '0001001110111001':   -1.000000,
        '0101011110111001':   -1.000000,
        '1001101001100101':   -1.000000,
        '1101111001100101':   -1.000000,
        '0110101010010101':   -1.000000,
        '0111101110010101':   -1.000000,
        '0110111011010101':   -1.000000,
        '0111111111010101':   -1.000000,
        '1001101101110101':   -1.000000,
        '1101111101110101':   -1.000000,
        '0101011011101101':   -1.000000,
        '1110011001011101':   -1.000000,
        '1111011101011101':   -1.000000,
        '0101011111111101':   -1.000000,
        '1011100100010011':   -1.000000,
        '0001100110110011':   -1.000000,
        '0011000110011011':   -1.000000,
        '0111010110011011':   -1.000000,
        '1001000100111011':   -1.000000,
        '1001010101111011':   -1.000000,
        '1011100101010111':   -1.000000,
        '1111110101010111':   -1.000000,
        '0101100110110111':   -1.000000,
        '0101110111110111':   -1.000000,
        '0111010111011111':   -1.000000,
        '1101010101111111':   -1.000000,
        '0111110101000011':   68.000000,
        '1000010011000011':   68.000000,
        '0110010011000011':   68.000000,
        '0110111011000011':   68.000000,
        '1101111011000011':   68.000000,
        '1101000010100011':   68.000000,
        '0111000010100011':   68.000000,
        '0010110010100011':   68.000000,
        '0111110010100011':   68.000000,
        '1100000110100011':   68.000000,
        '0010110110100011':   68.000000,
        '1000011110100011':   68.000000,
        '1100011110100011':   68.000000,
        '0111100001100011':   68.000000,
        '0010110001100011':   68.000000,
        '0111110001100011':   68.000000,
        '0111001001100011':   68.000000,
        '0010110101100011':   68.000000,
        '0010011101100011':   68.000000,
        '0010100011100011':   68.000000,
        '0110100011100011':   68.000000,
        '0010010011100011':   68.000000,
        '1101010011100011':   68.000000,
        '0010100111100011':   68.000000,
        '0110100111100011':   68.000000,
        '0111100111100011':   68.000000,
        '1000010111100011':   68.000000,
        '1100010111100011':   68.000000,
        '0010010111100011':   68.000000,
        '1101011111100011':   68.000000,
        '0010111000010011':   68.000000,
        '0001110100010011':   68.000000,
        '1100111100010011':   68.000000,
        '1101000010010011':   68.000000,
        '0111000010010011':   68.000000,
        '0010110010010011':   68.000000,
        '0111110010010011':   68.000000,
        '1000111110010011':   68.000000,
        '0010111110010011':   68.000000,
        '0111100001010011':   68.000000,
        '0010110001010011':   68.000000,
        '0111110001010011':   68.000000,
        '1100001001010011':   68.000000,
        '1101001001010011':   68.000000,
        '1100101101010011':   68.000000,
        '1000111101010011':   68.000000,
        '0010111101010011':   68.000000,
        '0010100011010011':   68.000000,
        '0110100011010011':   68.000000,
        '0010010011010011':   68.000000,
        '1100101011010011':   68.000000,
        '0111101011010011':   68.000000,
        '0010111011010011':   68.000000,
        '0010000111010011':   68.000000,
        '0001000111010011':   68.000000,
        '0001110111010011':   68.000000,
        '0010101111010011':   68.000000,
        '0110101111010011':   68.000000,
        '0010011111010011':   68.000000,
        '1100111111010011':   68.000000,
        '1011000000110011':   68.000000,
        '1011100000110011':   68.000000,
        '0001110100110011':   68.000000,
        '0001111100110011':   68.000000,
        '1100000010110011':   68.000000,
        '1011100010110011':   68.000000,
        '0111100010110011':   68.000000,
        '0111010010110011':   68.000000,
        '1000010011110011':   68.000000,
        '1100010011110011':   68.000000,
        '0110010011110011':   68.000000,
        '0110110011110011':   68.000000,
        '0010000111110011':   68.000000,
        '0001000111110011':   68.000000,
        '0010110111110011':   68.000000,
        '0001001111110011':   68.000000,
        '1011001111110011':   68.000000,
        '1000011111110011':   68.000000,
        '1100011111110011':   68.000000,
        '0001111111110011':   68.000000
    }

    # Minimum and maximum values are ok
    for bstring, energy in bitstrings.items():
        eigval = ham.test_bitstring(bstring)
        assert eigval == energy
