from proteinham.lattice import DiamondHamiltonian2D


def test_HPPH_2D():

    ham = DiamondHamiltonian2D('HPPH')
    ham.build_exp()
    bitstrings = {
        '1000010000000100000000000000':   -1.000000,
        '1000000000010001000000000000':   -1.000000,
        '0100010000001000000000000000':   -1.000000,
        '0100000100000010000000000000':   -1.000000,
        '0010000100000100000000000000':   -1.000000,
        '0010000001000001000000000000':   -1.000000,
        '0001000001000010000000000000':   -1.000000,
        '0001000000011000000000000000':   -1.000000,
        '1000100000000000100000000000':    0.000000,
        '1000100000000000010000000000':    0.000000,
        '1000100000000000000000000001':    0.000000,
        '1000010000000000010000000000':    0.000000,
        '1000010000000000001000000000':    0.000000,
        '1000000000010000000000000010':    0.000000,
        '1000000000010000000000000001':    0.000000,
        '0100010000000000010000000000':    0.000000,
        '0100010000000000001000000000':    0.000000,
        '0100001000000000001000000000':    0.000000,
        '0100001000000000000100000000':    0.000000,
        '0100001000000000000010000000':    0.000000,
        '0100000100000000000010000000':    0.000000,
        '0100000100000000000001000000':    0.000000,
        '0010000100000000000010000000':    0.000000,
        '0010000100000000000001000000':    0.000000,
        '0010000010000000000001000000':    0.000000,
        '0010000010000000000000100000':    0.000000,
        '0010000010000000000000010000':    0.000000,
        '0010000001000000000000010000':    0.000000,
        '0010000001000000000000001000':    0.000000,
        '0001000001000000000000010000':    0.000000,
        '0001000001000000000000001000':    0.000000,
        '0001000000100000000000001000':    0.000000,
        '0001000000100000000000000100':    0.000000,
        '0001000000100000000000000010':    0.000000,
        '0001000000010000000000000010':    0.000000,
        '0001000000010000000000000001':    0.000000,
        '1000100000000100000000000000':    2.000000,
        '1000100000000010000000000000':    2.000000,
        '1000100000000001000000000000':    2.000000,
        '1000010000000010000000000000':    2.000000,
        '1000010000000001000000000000':    2.000000,
        '1000001000000100000000000000':    2.000000,
        '1000000100000100000000000000':    2.000000,
        '1000000100000010000000000000':    2.000000,
        '1000000010000010000000000000':    2.000000,
        '1000000001000010000000000000':    2.000000,
        '1000000001000001000000000000':    2.000000,
        '1000000000100001000000000000':    2.000000,
        '1000000000010100000000000000':    2.000000,
        '1000000000010010000000000000':    2.000000,
        '0001100000000000000000100000':    6.000000,
        '0001100000000000000000010000':    6.000000,
        '0001100000000000000000001000':    6.000000,
        '0001100000000000000000000100':    6.000000,
        '0001100000000000000000000010':    6.000000,
        '0001010000000000100000000000':    6.000000,
        '0001010000000000000100000000':    6.000000,
        '0001010000000000000010000000':    6.000000,
        '0001010000000000000001000000':    6.000000,
        '0001010000000000000000100000':    6.000000,
        '0001010000000000000000010000':    6.000000,
        '0001010000000000000000001000':    6.000000,
        '0001010000000000000000000100':    6.000000,
        '0001010000000000000000000010':    6.000000,
        '0001010000000000000000000001':    6.000000,
        '0001001000000000100000000000':    6.000000,
        '0001001000000000010000000000':    6.000000,
        '0001001000000000000001000000':    6.000000,
        '0001001000000000000000100000':    6.000000,
        '0001001000000000000000010000':    6.000000,
        '0001001000000000000000001000':    6.000000,
        '0001001000000000000000000100':    6.000000,
        '0001001000000000000000000010':    6.000000,
        '0001001000000000000000000001':    6.000000,
        '0001000100000000100000000000':    6.000000,
        '0001000100000000010000000000':    6.000000,
        '0001000100000000001000000000':    6.000000,
        '0001000100000000000100000000':    6.000000,
        '0001000100000000000000100000':    6.000000,
        '0001000100000000000000010000':    6.000000,
        '0001000100000000000000001000':    6.000000,
        '0001000100000000000000000100':    6.000000,
        '0001000100000000000000000010':    6.000000,
        '0001000100000000000000000001':    6.000000,
        '0001000010000000100000000000':    6.000000,
        '0001000010000000010000000000':    6.000000,
        '0001000010000000001000000000':    6.000000,
        '0001000010000000000100000000':    6.000000,
        '0001000010000000000010000000':    6.000000,
        '0001000010000000000000001000':    6.000000,
        '0001000010000000000000000100':    6.000000,
        '0001000010000000000000000010':    6.000000,
        '0001000010000000000000000001':    6.000000,
        '1000001000001000000000000000':    9.000000,
        '1000000100001000000000000000':    9.000000,
        '1000000010001000000000000000':    9.000000,
        '1000000001001000000000000000':    9.000000,
        '1000000000101000000000000000':    9.000000,
        '0100100000000100000000000000':    9.000000,
        '0100000010000100000000000000':    9.000000 
    }

    # Minimum and maximum values are ok
    for bstring, energy in bitstrings.items():
        eigval = ham.test_bitstring(bstring)
        assert eigval == energy

def test_HPPHP_2D()

    ham = DiamondHamiltonian2D('HPPHP')
    ham.build_exp()

    bitstrings = {
        '1000010000000100000000000000001000000000000000000000':   -1.000000,
        '1000010000000100000000000000000100000000000000000000':   -1.000000,
        '1000000000010001000000000000000001000000000000000000':   -1.000000,
        '1000000000010001000000000000000000100000000000000000':   -1.000000,
        '0100010000001000000000000000100000000000000000000000':   -1.000000,
        '0100010000001000000000000000000000010000000000000000':   -1.000000,
        '0100000100000010000000000000000010000000000000000000':   -1.000000,
        '0100000100000010000000000000000001000000000000000000':   -1.000000,
        '0010000100000100000000000000010000000000000000000000':   -1.000000,
        '0010000100000100000000000000001000000000000000000000':   -1.000000,
        '0010000001000001000000000000000000100000000000000000':   -1.000000,
        '0010000001000001000000000000000000010000000000000000':   -1.000000,
        '0001000001000010000000000000000100000000000000000000':   -1.000000,
        '0001000001000010000000000000000010000000000000000000':   -1.000000,
        '0001000000011000000000000000100000000000000000000000':   -1.000000,
        '0001000000011000000000000000010000000000000000000000':   -1.000000,
        '1000100000000000100000000000000000001000000000000000':    0.000000,
        '1000100000000000100000000000000000000100000000000000':    0.000000,
        '1000100000000000100000000000000000000000000000000001':    0.000000,
        '1000100000000000010000000000010000000000000000000000':    0.000000,
        '1000100000000000010000000000000000000100000000000000':    0.000000,
        '1000100000000000010000000000000000000010000000000000':    0.000000,
        '1000100000000000000000000001000000010000000000000000':    0.000000,
        '1000100000000000000000000001000000000000000000000010':    0.000000,
        '1000100000000000000000000001000000000000000000000001':    0.000000,
        '1000010000000000010000000000100000000000000000000000':    0.000000,
        '1000010000000000010000000000000000000100000000000000':    0.000000,
        '1000010000000000010000000000000000000010000000000000':    0.000000,
        '1000010000000000001000000000001000000000000000000000':    0.000000,
        '1000010000000000001000000000000000000010000000000000':    0.000000,
        '1000010000000000001000000000000000000001000000000000':    0.000000,
        '1000000000010000000000000010000000100000000000000000':    0.000000,
        '1000000000010000000000000010000000000000000000000100':    0.000000,
        '1000000000010000000000000010000000000000000000000010':    0.000000,
        '1000000000010000000000000001100000000000000000000000':    0.000000,
        '1000000000010000000000000001000000000000000000000010':    0.000000,
        '1000000000010000000000000001000000000000000000000001':    0.000000,
        '0100010000000000010000000000100000000000000000000000':    0.000000,
        '0100010000000000010000000000000000000100000000000000':    0.000000,
        '0100010000000000010000000000000000000010000000000000':    0.000000,
        '0100010000000000001000000000001000000000000000000000':    0.000000,
        '0100010000000000001000000000000000000010000000000000':    0.000000,
        '0100010000000000001000000000000000000001000000000000':    0.000000,
        '0100001000000000001000000000010000000000000000000000':    0.000000,
        '0100001000000000001000000000000000000010000000000000':    0.000000,
        '0100001000000000001000000000000000000001000000000000':    0.000000,
        '0100001000000000000100000000000000000001000000000000':    0.000000,
        '0100001000000000000100000000000000000000100000000000':    0.000000,
        '0100001000000000000100000000000000000000010000000000':    0.000000,
        '0100001000000000000010000000000100000000000000000000':    0.000000,
        '0100000000010000100000000000100000000000000000000000':    8.000000,
        '0100000000010000100000000000000000001000000000000000':    8.000000,
        '0100000000010000100000000000000000000100000000000000':    8.000000,
        '0100000000010000100000000000000000000000000000000001':    8.000000,
        '0100000000010000010000000000100000000000000000000000':    8.000000,
        '0100000000010000010000000000010000000000000000000000':    8.000000,
        '0100000000010000010000000000000000000100000000000000':    8.000000,
        '0100000000010000010000000000000000000010000000000000':    8.000000,
        '0100000000010000001000000000010000000000000000000000':    8.000000,
        '0100000000010000001000000000001000000000000000000000':    8.000000,
        '0100000000010000001000000000000000000010000000000000':    8.000000,
        '0100000000010000001000000000000000000001000000000000':    8.000000,
        '0100000000010000000100000000001000000000000000000000':    8.000000,
        '0100000000010000000100000000000000000001000000000000':    8.000000,
        '0100000000010000000100000000000000000000100000000000':    8.000000,
        '0100000000010000000100000000000000000000010000000000':    8.000000,
        '0100000000010000000010000000001000000000000000000000':    8.000000,
        '0100000000010000000010000000000100000000000000000000':    8.000000,
        '0100000000010000000010000000000000000000010000000000':    8.000000,
        '0100000000010000000010000000000000000000001000000000':    8.000000,
        '0100000000010000000001000000000100000000000000000000':    8.000000,
        '0100000000010000000001000000000010000000000000000000':    8.000000,
        '0100000000010000000001000000000000000000001000000000':    8.000000,
        '0100000000010000000001000000000000000000000100000000':    8.000000,
        '0100000000010000000000100000000010000000000000000000':    8.000000,
        '0100000000010000000000100000000000000000000100000000':    8.000000,
        '0100000000010000000000100000000000000000000010000000':    8.000000,
        '0100000000010000000000100000000000000000000001000000':    8.000000,
        '0100000000010000000000010000000010000000000000000000':    8.000000,
        '0100000000010000000000010000000001000000000000000000':    8.000000,
        '0100000000010000000000010000000000000000000001000000':    8.000000,
        '0100000000010000000000010000000000000000000000100000':    8.000000,
        '0100000000010000000000001000000001000000000000000000':    8.000000,
        '0100000000010000000000001000000000100000000000000000':    8.000000,
        '0100000000010000000000001000000000000000000000100000':    8.000000,
        '0100000000010000000000001000000000000000000000010000':    8.000000,
        '0100000000010000000000000100000000100000000000000000':    8.000000,
        '0100000000010000000000000100000000000000000000010000':    8.000000,
        '0100000000010000000000000100000000000000000000001000':    8.000000,
        '0100000000010000000000000100000000000000000000000100':    8.000000,
        '0100000000010000000000000010100000000000000000000000':    8.000000,
        '0100000000010000000000000010010000000000000000000000':    8.000000,
        '0100000000010000000000000010001000000000000000000000':    8.000000,
        '0100000000010000000000000010000100000000000000000000':    8.000000,
        '0100000000010000000000000010000010000000000000000000':    8.000000,
        '0100000000010000000000000010000001000000000000000000':    8.000000,
        '0100000000010000000000000010000000001000000000000000':    8.000000,
        '0100000000010000000000000010000000000100000000000000':    8.000000,
        '0100000000010000000000000010000000000010000000000000':    8.000000,
        '0100000000010000000000000010000000000001000000000000':    8.000000 
    }

    # Minimum and maximum values are ok
    for bstring, energy in bitstrings.items():
        eigval = ham.test_bitstring(bstring)
        assert eigval == energy
